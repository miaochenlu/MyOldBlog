---
title: "Interpolation and Polynomial Approximation"
tags: Numarical_Analysis
key: page-NA7


---

<!--more-->

如果一个函数$y=f(x)$非常复杂甚至没有他的解析式，可以采样去构造一个近似函数。首先在$x_0,\cdots,x_n$处采样$y_0=f(x_0),\cdots,y_n=f(x_n)$,然后构造一个相对简单的approximating function $g(x)\approx f(x)$

如果对所有$i=0,\cdots,n$, $g(x)$满足$g(x_i)=f(x_i)$, 那么$g(x)$就叫做$f(x)$的***插值函数(interpolating function)***

<img src="../../../assets/images/image-20200412160049301.png" alt="image-20200412160049301" style="zoom:50%;" />



## 1. Interpolation and the Lagrange Polynomial

Find a polynomial of degree n, $P_n(x)=a_0+a_1x+\cdots+a_nx^n$, such that $P_n(x_i)=y_j$ for all $i=0,\cdots,n$.

Note: for any $i\not= j$, we must have $x_i\not= x_j$, 即$x_i$各不相同

#### 先考虑$n=1$的情况

Given $x_0,x_1;y_0,y_1$. Find $P_1(x)=a_0+a_1x$ such that $P_1(x_0)=y_0$ and $P_1(x_1)=y_1$

$P_1$是经过$(x_0,y_0),(x_1,y_1)$的线性函数

$$P_1(x)=y_0+\frac{y_1-y_0}{x_1-x_0}(x-x_0)=(\frac{x-x_1}{x_0-x_1})y_0+(\frac{x-x_0}{x_1-x_0})y_1$$

令$\frac{x-x_1}{x_0-x_1}=L_{1,0}(x)$

令$\frac{x-x_0}{x_1-x_0}=L_{1,1}(x)$

$L_{i,j}$是Lagrange Basis, 第一个下标代表几阶，第二个下标代表在x为x几时该项为1,$L_{1,i}(x_j)=\delta_{ij}$

$P_1(x)=\sum_{i=0}^1 L_{1,i}(x)y_i$

<br>

#### 再考虑$n\geq 1$

Find $L_{n,i}(x)$ for $i=0,\cdots,n$ such that $L_{n,i}(x_j)=\delta_{ij}$. Then let $P_n(x)=\sum_{i=0}^n L_{n,i}(x)y_i$. Hence $P_n(x_i)=y_i$

Each $L_{n,i}$ has n roots $x_0,\cdots,\widehat{x_i},\cdots,x_n$($\widehat{x_i}$是跳过$x_i$的意思)

$L_{n,i}(x)=C_i(x-x_0)\cdots(\widehat{x-x_i})\cdots(x-x_n)=C_i\Pi_{j\not= i}(x-x_j)$

$L_{n,i}(x_i)=1\Rightarrow C_i=\Pi_{j\not= i}\frac{1}{(x_i-x_j)}$

因此

$L_{n,i}(x)=\Pi_{j\not=i,j=0}^n\frac{(x-x_j)}{(x_i-x_j)}$

$P_n(x)=\sum_{i=0}^n L_{n,i}(x)y_i$

<br>

`Theorem`{:.error}

If $x_0,x_1,\cdots,x_n$ are n+1 distinct numbers and f is a function whose values are given at these numbers, then the n-th Lagrange interpolating polynomial is unique

Proof:

srds, 这个问题和Lagrange并没有什么大的关系

反证：如果不是unique的

那么就会存在两个polynomials $P_n(x)$和 $Q_n(x)$同时满足插值条件

$D(x)=P_n(x)-Q_n(x)$是一个$\leq n$阶的多项式

但是$D(x)$有$x_0,x_1,\cdots,x_n$这n+1个根，然而n阶多项式最多只有n个根，矛盾！

<br>

从另一个方面来证明

令$P_n(x)=a_0+a_1x+\cdots+a_nx^n$

$P_n(x_0)=y_0, P_n(x_1)=y_1,\cdots,P_n(x_n)=y_n$

最后可以写成

$$\left[\begin{matrix}1&x_0&x_0^2&\cdots&x_0^n\\ 1&x_1&x_1^2&\cdots&x_1^2\\\cdots\\1&x_n&x_n^2&\cdots&x_n^n \end{matrix}\right]\left[\begin{matrix}a_0\\a_1\\\vdots\\a_n\end{matrix}\right]=\left[\begin{matrix}y_0\\y_1\\\vdots\\y_n\end{matrix}\right]$$

$X\vec{a}=\vec{y}$

因为x的值是互不相同的，因此X矩阵是可逆矩阵，所以$\vec{a}$是唯一的

<br>

Note:  The interplating polynomial is NOT unique unless its degree is constrained to be no greater than $n$.

Counterexample: $P(x)=L_n(x)+p(x)\Pi_{i=0}^n(x-x_i)$, where $p(x)$ can be a polynomial of any degree.

<br>

# 2. Analyze the Remainder

Suppose $a\leq x_0< x_1< \cdots <x_n\leq b$ and $f\in C^{n+1}[a,b]$

Consider the truncation error: $R_n(x)=f(x)-P_n(x)$



`Rolle's Theorem`{:.error}

If $\varphi(x)$ is sufficiently smooth with $\varphi(x_0)=\varphi(x_1)=0$, then there exists $\xi\in(x_0,x_1)$ such that $\varphi'(\xi)=0$

<img src="../../../assets/images/image-20200412202757704.png" alt="image-20200412202757704" style="zoom:40%;" />

In general, if $\varphi(x_0)=\varphi(x_1)=\varphi(x_2)=0$

There exist $\xi_0\in(x_0,x_1),\xi_1\in(x_1,x_2)$ such that $\varphi'(\xi_0)=\varphi'(\xi_1)=0$

$\Rightarrow$ There exists $\xi\in (\xi_0,\xi_1)$ such that $\varphi''(\xi)=0$

再推广

$\varphi(x_0)=\cdots=\varphi(x_n)=0\Rightarrow$ There exists $\xi\in(a,b)$ such that $\varphi^{(n)}(\xi)=0$

<br>

$R_n(x)=f(x)-P_n(x)$ ,其中$f\in C^{n+1}[a,b]$并且$P_n(x)$是一个n阶多项式

那么$R_n(x)$至少有n+1个根$\Rightarrow$ $R_n(x)=K(x)\Pi_{i=0}^n(x-x_i)$ ($K(x)$必定是个连续函数)

对于任何$x\not= x_i, i=0,1,\cdots,n$ . 以$t\in[a,b]$ 为自变量定义函数$g(t)$

$$g(t)=R_n(t)-K(x)\Pi_{i=0}^n(t-x_i)$$

$g(t)$有$n+2$个不同的根$x_0,x_1,\cdots,x_n,x$(多了一个x)

则根据前面的Rolle定理，$g^{(n+1)}(\xi_x)=0,\xi_x\in(a,b)$

根据$g(t)=R_n(t)-K(x)\Pi_{i=0}^n(t-x_i)$, 对t求n+1阶导，$g^{(n+1)}(\xi_x)=R^{(n+1)}_n(\xi_x)-K(x)(n+1)!=f^{(n+1)}(\xi_x)-P_n^{(n+1)}(\xi_x)-K(x)(n+1)!$

推出$K(x)=\frac{f^{(n+1)}(\xi_x)}{(n+1)!}$

所以最后得到

$$R_n(x)=\frac{f^{(n+1)}(\xi_x)}{(n+1)!}\Pi_{i=0}^n(x-x_i)$$

<br>

Note:

在大多数情况下$\xi_x$是不能被确定的，但是我们可以知道他的upper bound. 即估计$M_{n+1}$使得$\vert f^{(n+1)}(x)\vert\leq M_{n+1}$ for all $x\in (a,b)$, 那么$R_n(x)\leq \frac{M_{n+1}}{(n+1)!}\Pi_{i=0}^n\vert x-x_i\vert$

插值函数对于任何阶<=n的多项式函数都是accurate的，因为$f^{(n+1)}(x)\equiv 0$

<img src="../../../assets/images/image-20200412212808688.png" alt="image-20200412212808688" style="zoom:50%;" />

首先$L_{5,2}(x_2)=1$其他都为0

其次连续

最后二阶连续

<br>

在计算机中很多计算时通过查表来实现的。假设为$f(x)=e^x,x\in[0,1]$准备了一张表。假设表中每一项accurate up to 8 decimal places并且步长为h。那么为了使absolute error最多为$10^{-6}$的话h应该怎么选择

Solution:

将$[0,1]$划分成n个等长区间$[x_0,x_1],[x_1,x_2],\cdots,[x_{n-1},x_n]$, 并且x在区间$[x_k,x_{k+1}]$内

$\vert f(x)-P_1(x)\vert =\vert \frac{f^{(2)}(\xi)}{2!}(x-x_k)(x-x_{k+1})\vert$

$=\vert\frac{e^{\xi}}{2}(x-kh)(x-(k+1)h)\vert\leq \frac{e}{2}\times \frac{h^2}{4}$

<br>

$\frac{eh^2}{8}\leq 10^{-6}\Rightarrow h\leq 1.72\times 10^{-3}$

Simply take n = 1000 and h = 0.001

<br>





















